{% extends 'base.html' %}
{% block body %}
<style>
    /* Estrellas interactivas: Se rellenan de derecha a izquierda */
    .star-rating { display: flex; flex-direction: row-reverse; justify-content: flex-end; }
    .star-rating input { display: none; }
    .star-rating label { font-size: 2.5rem; color: #ddd; cursor: pointer; }
    .star-rating label:before { content: "\2605"; }
    .star-rating input:checked ~ label, .star-rating label:hover, .star-rating label:hover ~ label { color: #ffc107; }
</style>

<div class="container py-4">
    <div class="card mb-4 shadow-sm border-0">
        <div class="row g-0">
            <div class="col-md-3">
                <img src="{{ album.image }}" class="img-fluid rounded-start" alt="{{ album.title }}">
            </div>
            <div class="col-md-9 p-4">
                <h2 class="fw-bold">{{ album.title }}</h2>
                <p class="mb-1"><strong>Artista:</strong> {{ album.artist|join:", " }}</p>
                <p class="mb-1"><strong>Fecha de Lanzamiento:</strong> {{ album.release_date }}</p>
                <p class="mb-1"><strong>Géneros:</strong> {{ album.genres|join:", " }}</p>
                <p class="mb-1"><strong>Número de canciones:</strong> {{ album.numSongs }}</p>
            </div>
        </div>
    </div>

    <div class="card p-4 mb-5 shadow-sm bg-light border-0">
        <form method="post">
            {% csrf_token %}
            <label class="form-label fw-bold">Puntúa este álbum:</label>
            <div class="star-rating mb-3">
                <input type="radio" name="rating" id="s5" value="5" required><label for="s5"></label>
                <input type="radio" name="rating" id="s4" value="4"><label for="s4"></label>
                <input type="radio" name="rating" id="s3" value="3"><label for="s3"></label>
                <input type="radio" name="rating" id="s2" value="2"><label for="s2"></label>
                <input type="radio" name="rating" id="s1" value="1"><label for="s1"></label>
            </div>

            <label class="form-label fw-bold">Tu opinión (Opcional):</label>
            <textarea name="review" class="form-control mb-3" rows="3"></textarea>

            <button type="submit" class="btn btn-primary" style="background-color: var(--primary-orange); border:none;">Publicar Review</button>
        </form>
    </div>

    <h4 class="mb-4">Opiniones de la comunidad</h4>
    <div class="row">
        {% for r in reviews %}
            <div class="col-md-6 mb-3">
                <div class="card h-100 shadow-sm border-0" style="border-left: 4px solid var(--primary-orange) !important;">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <h6 class="fw-bold">{{ r.user }}</h6>
                            <span class="text-warning">
                                {% for i in "12345" %}
                                    {% if forloop.counter <= r.rating %}★{% else %}☆{% endif %}
                                {% endfor %}
                            </span>
                        </div>
                        <small class="text-muted">{{ r.reviewDate|date:"d/m/Y H:i" }}</small>
                        <p class="mt-2 mb-0">{% if r.review %}"{{ r.review }}"{% else %}<em class="text-muted">Sin comentario.</em>{% endif %}</p>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}